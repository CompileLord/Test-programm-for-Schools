{% extends 'base.html' %}

{% block title %}Results: {{ quiz.title }} - QuizMaster{% endblock %}

{% block content %}
<div class="results-header {% if attempt.get_percentage >= 70 %}results-success{% elif attempt.get_percentage >= 50 %}results-warning{% else %}results-fail{% endif %}">
    <div class="container">
        <div class="results-score-circle">
            <span class="score-number">{{ attempt.get_percentage }}%</span>
        </div>
        <h1>Quiz Complete!</h1>
        <div class="results-summary">
            <span>ğŸ“ {{ attempt.score }}/{{ attempt.total_questions }} correct answers</span>
            <span>ğŸ“… {{ attempt.date_taken|date:"F d, Y H:i" }}</span>
        </div>
        <p class="results-message">
            {% if attempt.get_percentage >= 70 %}
            ğŸ‰ Excellent work! You've mastered this quiz!
            {% elif attempt.get_percentage >= 50 %}
            ğŸ‘ Good job! Keep practicing to improve.
            {% else %}
            ğŸ’ª Keep learning! Review the material and try again.
            {% endif %}
        </p>
    </div>
</div>

<section class="section">
    <div class="container">
        <h2 class="section-title">Answer Review</h2>
        
        {% for result in results %}
        <div class="result-card {% if result.is_correct %}result-correct{% else %}result-incorrect{% endif %}">
            <div class="result-header">
                <span class="result-number">{{ forloop.counter }}</span>
                <span class="result-status">
                    {% if result.is_correct %}âœ“ Correct{% else %}âœ— Incorrect{% endif %}
                </span>
            </div>
            <h3 class="result-question">{{ result.question.text }}</h3>
            <div class="result-answers">
                <div class="result-answer">
                    <strong>Your answer:</strong>
                    {% if result.selected %}
                    <span class="{% if result.is_correct %}text-success{% else %}text-error{% endif %}">
                        {{ result.selected.text }}
                    </span>
                    {% else %}
                    <span class="text-muted">No answer selected</span>
                    {% endif %}
                </div>
                {% if not result.is_correct and result.correct %}
                <div class="result-answer">
                    <strong>Correct answer:</strong>
                    <span class="text-success">{{ result.correct.text }}</span>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
        
        <div class="results-actions">
            <a href="{% url 'take_quiz' quiz.pk %}" class="btn btn-primary">ğŸ”„ Retake Quiz</a>
            <a href="{% url 'quiz_detail' quiz.pk %}" class="btn btn-outline">â† Back to Quiz</a>
            <a href="{% url 'main' %}" class="btn btn-outline">ğŸ  Home</a>
        </div>
    </div>
</section>
{% endblock %}
